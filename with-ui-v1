<<<FILE: src/main/java/com/example/generator/SpringbootProjectGeneratorApplication.java>>>
package com.example.generator;import org.springframework.boot.*;import org.springframework.boot.autoconfigure.*;@SpringBootApplication public class SpringbootProjectGeneratorApplication{public static void main(String[]a){SpringApplication.run(SpringbootProjectGeneratorApplication.class,a);}}
<<<END FILE>>>

<<<FILE: src/main/java/com/example/generator/controller/ProjectController.java>>>
package com.example.generator.controller;import com.example.generator.service.ProjectGeneratorService;import jakarta.servlet.http.*;import lombok.*;import org.springframework.stereotype.*;import org.springframework.web.bind.annotation.*;import java.io.*;@Controller @RequiredArgsConstructor public class ProjectController{private final ProjectGeneratorService s;@PostMapping("/generate")public void g(@RequestParam String groupId,@RequestParam String artifactId,@RequestParam String packageName,@RequestParam(defaultValue="1.0.0")String version,HttpServletResponse r)throws IOException{byte[]z=s.generateAsZip(groupId,artifactId,packageName,version);r.setContentType("application/zip");r.setHeader("Content-Disposition","attachment; filename="+artifactId+".zip");r.getOutputStream().write(z);}}
<<<END FILE>>>

<<<FILE: src/main/java/com/example/generator/service/ProjectGeneratorService.java>>>
package com.example.generator.service;import com.example.generator.util.ZipUtil;import freemarker.template.*;import org.springframework.stereotype.*;import java.io.*;import java.nio.file.*;import java.util.*;@Service public class ProjectGeneratorService{private final Configuration c;public ProjectGeneratorService()throws IOException{c=new Configuration(Configuration.VERSION_2_3_9);c.setClassLoaderForTemplateLoading(getClass().getClassLoader(),"templates");}public byte[] generateAsZip(String g,String a,String p,String v)throws IOException{Path t=Files.createTempDirectory("x");Path root=t.resolve(a);Path app=root.resolve("myapp");Path dep=root.resolve("myDeploy");Files.createDirectories(app);Files.createDirectories(dep);Map<String,Object>d=Map.of("groupId",g,"artifactId",a,"packageName",p,"version",v);Path javaD=app.resolve("src/main/java/"+p.replace('.','/'));Path res=app.resolve("src/main/resources");Files.createDirectories(javaD);Files.createDirectories(res);gen("pom.xml.ftl",app.resolve("pom.xml"),d);gen("Application.ftl",javaD.resolve(cap(a)+"Application.java"),d);gen("application.properties.ftl",res.resolve("application.properties"),d);Path b=dep.resolve("build");Path dock=dep.resolve("docker");Path zip=dep.resolve("zip");Path ver=dep.resolve("version");Files.createDirectories(b);Files.createDirectories(dock);Files.createDirectories(zip);Files.createDirectories(ver);gen("releng/build.sh.ftl",b.resolve("build.sh"),d);gen("releng/build.ps1.ftl",b.resolve("build.ps1"),d);gen("releng/Dockerfile.ftl",dock.resolve("Dockerfile"),d);gen("releng/package.sh.ftl",zip.resolve("package.sh"),d);gen("releng/version.txt.ftl",ver.resolve("version.txt"),d);return ZipUtil.zipDirectoryToBytes(root);}private void gen(String t,Path f,Map<String,Object>d)throws IOException{Template T=c.getTemplate(t);try(Writer w=Files.newBufferedWriter(f)){T.process(d,w);}catch(Exception e){throw new RuntimeException(e);}}private String cap(String s){return Character.toUpperCase(s.charAt(0))+s.substring(1);}}
<<<END FILE>>>

<<<FILE: src/main/java/com/example/generator/util/ZipUtil.java>>>
package com.example.generator.util;import java.io.*;import java.nio.file.*;import java.util.zip.*;public class ZipUtil{public static byte[] zipDirectoryToBytes(Path p)throws IOException{ByteArrayOutputStream o=new ByteArrayOutputStream();ZipOutputStream z=new ZipOutputStream(o);Files.walk(p).forEach(x->{try{if(Files.isDirectory(x))return;z.putNextEntry(new ZipEntry(p.relativize(x).toString()));Files.copy(x,z);z.closeEntry();}catch(Exception e){throw new RuntimeException(e);}});z.close();return o.toByteArray();}}
<<<END FILE>>>
